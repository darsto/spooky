PROJECT(spooky)
CMAKE_MINIMUM_REQUIRED(VERSION 2.8.12)

SET(CMAKE_CONFIGURATION_TYPES "Game;Debug;Editor;EditorDebug;Simulation" CACHE STRING "" FORCE)
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/bin")

SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++14 -iquote ${CMAKE_CURRENT_SOURCE_DIR}/src")
SET(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake)


IF (CMAKE_BUILD_TYPE MATCHES "^(Editor|EditorDebug)$")
    SET(EDITOR 1)
ENDIF ()

IF (CMAKE_BUILD_TYPE MATCHES "^(Debug|EditorDebug|Simulation)$")
    SET(DEBUG 1)
ENDIF ()

IF (CMAKE_BUILD_TYPE MATCHES Simulation)
    SET(SIMULATION 1)
ENDIF ()

IF (ANDROID)
    INCLUDE_DIRECTORIES(${ANDROID_NDK_INCLUDE_DIR})
ENDIF ()

INCLUDE_DIRECTORIES(src)
ADD_SUBDIRECTORY(src)

INCLUDE(FindPkgConfig)

INCLUDE(FindLua REQUIRED)
FIND_PACKAGE(Lua REQUIRED)

INCLUDE_DIRECTORIES(${LUA_INCLUDE_DIR} ${LUA_INCLUDE_DIR}/lua5.1 ${LUA_INCLUDE_DIR}/lua5.2 ${LUA_INCLUDE_DIR}/lua5.3)
INCLUDE_DIRECTORIES(src/ext/kaguya/include)

IF (EDITOR)
    SET(PROJECT_NAME ${PROJECT_NAME}_editor)
ELSE ()
    SET(PROJECT_NAME ${PROJECT_NAME}_game)
ENDIF ()

ADD_SUBDIRECTORY(tests)

ADD_EXECUTABLE(${PROJECT_NAME} main.cpp)

TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${PROJECT_NAME}_lib)